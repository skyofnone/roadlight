   1                     ; C Compiler for STM8 (COSMIC Software)
   2                     ; Parser V4.10.2 - 02 Nov 2011
   3                     ; Generator (Limited) V4.3.7 - 29 Nov 2011
   4                     ; Optimizer V4.3.6 - 29 Nov 2011
  21                     .const:	section	.text
  22  0000               _IRTabFF00:
  23  0000 ff            	dc.b	255
  24  0001 ff            	dc.b	255
  25  0002 ff            	dc.b	255
  26  0003 ff            	dc.b	255
  27  0004 ff            	dc.b	255
  28  0005 ff            	dc.b	255
  29  0006 ff            	dc.b	255
  30  0007 ff            	dc.b	255
  31  0008 ff            	dc.b	255
  32  0009 ff            	dc.b	255
  33  000a ff            	dc.b	255
  34  000b ff            	dc.b	255
  35  000c ff            	dc.b	255
  36  000d ff            	dc.b	255
  37  000e ff            	dc.b	255
  38  000f ff            	dc.b	255
  39  0010 ff            	dc.b	255
  40  0011 ff            	dc.b	255
  41  0012 ff            	dc.b	255
  42  0013 ff            	dc.b	255
  43  0014 ff            	dc.b	255
  44  0015 15            	dc.b	21
  45  0016 ff            	dc.b	255
  46  0017 ff            	dc.b	255
  47  0018 ff            	dc.b	255
  48  0019 ff            	dc.b	255
  49  001a ff            	dc.b	255
  50  001b ff            	dc.b	255
  51  001c ff            	dc.b	255
  52  001d ff            	dc.b	255
  53  001e ff            	dc.b	255
  54  001f ff            	dc.b	255
  55  0020 ff            	dc.b	255
  56  0021 ff            	dc.b	255
  57  0022 ff            	dc.b	255
  58  0023 ff            	dc.b	255
  59  0024 ff            	dc.b	255
  60  0025 45            	dc.b	69
  61  0026 ff            	dc.b	255
  62  0027 ff            	dc.b	255
  63  0028 ff            	dc.b	255
  64  0029 ff            	dc.b	255
  65  002a ff            	dc.b	255
  66  002b ff            	dc.b	255
  67  002c ff            	dc.b	255
  68  002d ff            	dc.b	255
  69  002e ff            	dc.b	255
  70  002f ff            	dc.b	255
  71  0030 ff            	dc.b	255
  72  0031 ff            	dc.b	255
  73  0032 ff            	dc.b	255
  74  0033 ff            	dc.b	255
  75  0034 ff            	dc.b	255
  76  0035 ff            	dc.b	255
  77  0036 ff            	dc.b	255
  78  0037 ff            	dc.b	255
  79  0038 ff            	dc.b	255
  80  0039 ff            	dc.b	255
  81  003a ff            	dc.b	255
  82  003b ff            	dc.b	255
  83  003c ff            	dc.b	255
  84  003d ff            	dc.b	255
  85  003e ff            	dc.b	255
  86  003f ff            	dc.b	255
  87  0040 ff            	dc.b	255
  88  0041 ff            	dc.b	255
  89  0042 ff            	dc.b	255
  90  0043 ff            	dc.b	255
  91  0044 ff            	dc.b	255
  92  0045 25            	dc.b	37
  93  0046 ff            	dc.b	255
  94  0047 ff            	dc.b	255
  95  0048 ff            	dc.b	255
  96  0049 ff            	dc.b	255
  97  004a ff            	dc.b	255
  98  004b ff            	dc.b	255
  99  004c ff            	dc.b	255
 100  004d ff            	dc.b	255
 101  004e ff            	dc.b	255
 102  004f ff            	dc.b	255
 103  0050 ff            	dc.b	255
 104  0051 ff            	dc.b	255
 105  0052 ff            	dc.b	255
 106  0053 ff            	dc.b	255
 107  0054 ff            	dc.b	255
 108  0055 ff            	dc.b	255
 109  0056 ff            	dc.b	255
 110  0057 ff            	dc.b	255
 111  0058 ff            	dc.b	255
 112  0059 ff            	dc.b	255
 113  005a ff            	dc.b	255
 114  005b ff            	dc.b	255
 115  005c ff            	dc.b	255
 116  005d ff            	dc.b	255
 117  005e ff            	dc.b	255
 118  005f ff            	dc.b	255
 119  0060 ff            	dc.b	255
 120  0061 ff            	dc.b	255
 121  0062 ff            	dc.b	255
 122  0063 ff            	dc.b	255
 123  0064 ff            	dc.b	255
 124  0065 ff            	dc.b	255
 125  0066 ff            	dc.b	255
 126  0067 ff            	dc.b	255
 127  0068 ff            	dc.b	255
 128  0069 ff            	dc.b	255
 129  006a ff            	dc.b	255
 130  006b ff            	dc.b	255
 131  006c ff            	dc.b	255
 132  006d ff            	dc.b	255
 133  006e ff            	dc.b	255
 134  006f ff            	dc.b	255
 135  0070 ff            	dc.b	255
 136  0071 ff            	dc.b	255
 137  0072 ff            	dc.b	255
 138  0073 ff            	dc.b	255
 139  0074 ff            	dc.b	255
 140  0075 ff            	dc.b	255
 141  0076 ff            	dc.b	255
 142  0077 ff            	dc.b	255
 143  0078 ff            	dc.b	255
 144  0079 ff            	dc.b	255
 145  007a ff            	dc.b	255
 146  007b ff            	dc.b	255
 147  007c ff            	dc.b	255
 148  007d ff            	dc.b	255
 149  007e ff            	dc.b	255
 150  007f ff            	dc.b	255
 151  0080 ff            	dc.b	255
 152  0081 ff            	dc.b	255
 153  0082 ff            	dc.b	255
 154  0083 ff            	dc.b	255
 155  0084 ff            	dc.b	255
 156  0085 85            	dc.b	133
 157  0086 ff            	dc.b	255
 158  0087 ff            	dc.b	255
 159  0088 ff            	dc.b	255
 160  0089 ff            	dc.b	255
 161  008a ff            	dc.b	255
 162  008b ff            	dc.b	255
 163  008c ff            	dc.b	255
 164  008d ff            	dc.b	255
 165  008e ff            	dc.b	255
 166  008f ff            	dc.b	255
 167  0090 ff            	dc.b	255
 168  0091 ff            	dc.b	255
 169  0092 ff            	dc.b	255
 170  0093 ff            	dc.b	255
 171  0094 ff            	dc.b	255
 172  0095 ff            	dc.b	255
 173  0096 ff            	dc.b	255
 174  0097 ff            	dc.b	255
 175  0098 ff            	dc.b	255
 176  0099 ff            	dc.b	255
 177  009a ff            	dc.b	255
 178  009b ff            	dc.b	255
 179  009c ff            	dc.b	255
 180  009d ff            	dc.b	255
 181  009e ff            	dc.b	255
 182  009f ff            	dc.b	255
 183  00a0 ff            	dc.b	255
 184  00a1 ff            	dc.b	255
 185  00a2 ff            	dc.b	255
 186  00a3 ff            	dc.b	255
 187  00a4 ff            	dc.b	255
 188  00a5 ff            	dc.b	255
 189  00a6 ff            	dc.b	255
 190  00a7 ff            	dc.b	255
 191  00a8 ff            	dc.b	255
 192  00a9 ff            	dc.b	255
 193  00aa ff            	dc.b	255
 194  00ab ff            	dc.b	255
 195  00ac ff            	dc.b	255
 196  00ad ff            	dc.b	255
 197  00ae ff            	dc.b	255
 198  00af ff            	dc.b	255
 199  00b0 ff            	dc.b	255
 200  00b1 ff            	dc.b	255
 201  00b2 ff            	dc.b	255
 202  00b3 ff            	dc.b	255
 203  00b4 ff            	dc.b	255
 204  00b5 ff            	dc.b	255
 205  00b6 ff            	dc.b	255
 206  00b7 ff            	dc.b	255
 207  00b8 ff            	dc.b	255
 208  00b9 ff            	dc.b	255
 209  00ba ff            	dc.b	255
 210  00bb ff            	dc.b	255
 211  00bc ff            	dc.b	255
 212  00bd ff            	dc.b	255
 213  00be ff            	dc.b	255
 214  00bf ff            	dc.b	255
 215  00c0 ff            	dc.b	255
 216  00c1 ff            	dc.b	255
 217  00c2 ff            	dc.b	255
 218  00c3 ff            	dc.b	255
 219  00c4 ff            	dc.b	255
 220  00c5 ff            	dc.b	255
 221  00c6 ff            	dc.b	255
 222  00c7 ff            	dc.b	255
 223  00c8 ff            	dc.b	255
 224  00c9 ff            	dc.b	255
 225  00ca ff            	dc.b	255
 226  00cb ff            	dc.b	255
 227  00cc ff            	dc.b	255
 228  00cd ff            	dc.b	255
 229  00ce ff            	dc.b	255
 230  00cf ff            	dc.b	255
 231  00d0 ff            	dc.b	255
 232  00d1 ff            	dc.b	255
 233  00d2 ff            	dc.b	255
 234  00d3 ff            	dc.b	255
 235  00d4 ff            	dc.b	255
 236  00d5 ff            	dc.b	255
 237  00d6 ff            	dc.b	255
 238  00d7 ff            	dc.b	255
 239  00d8 ff            	dc.b	255
 240  00d9 ff            	dc.b	255
 241  00da ff            	dc.b	255
 242  00db ff            	dc.b	255
 243  00dc ff            	dc.b	255
 244  00dd ff            	dc.b	255
 245  00de ff            	dc.b	255
 246  00df ff            	dc.b	255
 247  00e0 ff            	dc.b	255
 248  00e1 ff            	dc.b	255
 249  00e2 ff            	dc.b	255
 250  00e3 ff            	dc.b	255
 251  00e4 ff            	dc.b	255
 252  00e5 ff            	dc.b	255
 253  00e6 ff            	dc.b	255
 254  00e7 ff            	dc.b	255
 255  00e8 ff            	dc.b	255
 256  00e9 ff            	dc.b	255
 257  00ea ff            	dc.b	255
 258  00eb ff            	dc.b	255
 259  00ec ff            	dc.b	255
 260  00ed ff            	dc.b	255
 261  00ee ff            	dc.b	255
 262  00ef ff            	dc.b	255
 263  00f0 ff            	dc.b	255
 264  00f1 ff            	dc.b	255
 265  00f2 ff            	dc.b	255
 266  00f3 ff            	dc.b	255
 267  00f4 ff            	dc.b	255
 268  00f5 ff            	dc.b	255
 269  00f6 ff            	dc.b	255
 270  00f7 ff            	dc.b	255
 271  00f8 ff            	dc.b	255
 272  00f9 ff            	dc.b	255
 273  00fa ff            	dc.b	255
 274  00fb ff            	dc.b	255
 275  00fc ff            	dc.b	255
 276  00fd ff            	dc.b	255
 277  00fe ff            	dc.b	255
 278  00ff ff            	dc.b	255
 310                     ; 49 void IrTask_Init(void)
 310                     ; 50 {
 312                     .text:	section	.text,new
 313  0000               _IrTask_Init:
 317                     ; 51 	GPIO_Init(IrInPort, IrInPin, GPIO_MODE_IN_FL_IT);
 319  0000 4b20          	push	#32
 320  0002 4b20          	push	#32
 321  0004 ae5014        	ldw	x,#20500
 322  0007 cd0000        	call	_GPIO_Init
 324  000a 85            	popw	x
 325                     ; 53 	EXTI_DeInit();
 327  000b cd0000        	call	_EXTI_DeInit
 329                     ; 54 	EXTI_SetExtIntSensitivity(EXTI_PORT_GPIOE,EXTI_SENSITIVITY_RISE_FALL);//下降沿触发中断
 331  000e ae0403        	ldw	x,#1027
 333                     ; 59 }
 336  0011 cc0000        	jp	_EXTI_SetExtIntSensitivity
 363                     ; 61 void Init_TIM2(void)
 363                     ; 62 {
 364                     .text:	section	.text,new
 365  0000               _Init_TIM2:
 369                     ; 63 	TIM2_DeInit();
 371  0000 cd0000        	call	_TIM2_DeInit
 373                     ; 65 	TIM2_TimeBaseInit(TIM2_PRESCALER_16, 65535);//1us一次
 375  0003 aeffff        	ldw	x,#65535
 376  0006 89            	pushw	x
 377  0007 a604          	ld	a,#4
 378  0009 cd0000        	call	_TIM2_TimeBaseInit
 380  000c 85            	popw	x
 381                     ; 66 	TIM2_ITConfig(TIM2_IT_UPDATE, ENABLE);
 383  000d ae0101        	ldw	x,#257
 384  0010 cd0000        	call	_TIM2_ITConfig
 386                     ; 67 	TIM2_Cmd(ENABLE);
 388  0013 a601          	ld	a,#1
 390                     ; 68 }
 393  0015 cc0000        	jp	_TIM2_Cmd
 417                     ; 69 void Ir_TimeOut(void)    //IR计时溢出处理 1ms一次
 417                     ; 70 {
 418                     .text:	section	.text,new
 419  0000               _Ir_TimeOut:
 423                     ; 71     ir_code.boverflow++;
 425  0000 3c07          	inc	_ir_code+5
 426                     ; 72     if (ir_code.boverflow > 112) //112*1ms ~= 112ms
 428  0002 b607          	ld	a,_ir_code+5
 429  0004 a171          	cp	a,#113
 430  0006 2502          	jrult	L14
 431                     ; 74         ir_code.bState = 0;
 433  0008 3f04          	clr	_ir_code+2
 434  000a               L14:
 435                     ; 76 }
 438  000a 81            	ret	
 441                     	bsct
 442  0000               L34_flag_IrDataIn:
 443  0000 00            	dc.b	0
 489                     ; 262 void Ir_Receive(void)	 //循环IR接收
 489                     ; 263 {
 490                     .text:	section	.text,new
 491  0000               _Ir_Receive:
 493  0000 89            	pushw	x
 494       00000002      OFST:	set	2
 497                     ; 264 	uint16_t cnt_ir_time = 0;
 499                     ; 267 	cnt_ir_time = TIM2_GetCounter();
 501  0001 cd0000        	call	_TIM2_GetCounter
 503  0004 1f01          	ldw	(OFST-1,sp),x
 504                     ; 268 	if(cnt_ir_time>= 200)
 506  0006 a300c8        	cpw	x,#200
 507  0009 2502          	jrult	L76
 508                     ; 269 		ir_code.bState = 0;
 510  000b 3f04          	clr	_ir_code+2
 511  000d               L76:
 512                     ; 270 	if((IrDataIn == flag_IrDataIn))//只检测低电平时间
 514  000d b600          	ld	a,L34_flag_IrDataIn
 515  000f a120          	cp	a,#32
 516  0011 2604          	jrne	L43
 517  0013 a601          	ld	a,#1
 518  0015 2001          	jra	L63
 519  0017               L43:
 520  0017 4f            	clr	a
 521  0018               L63:
 522  0018 c45015        	and	a,20501
 523  001b c75015        	ld	20501,a
 524  001e 260f          	jrne	L44
 525                     ; 272 		return;
 527                     ; 275 	if(IrDataIn == 0)
 529  0020 c75015        	ld	20501,a
 530  0023 725d5015      	tnz	20501
 531  0027 2708          	jreq	L37
 532                     ; 277 		flag_IrDataIn = 0;
 534  0029 b700          	ld	L34_flag_IrDataIn,a
 535                     ; 278 		TIM2_SetCounter(0);
 537  002b 5f            	clrw	x
 538  002c cd0000        	call	_TIM2_SetCounter
 540                     ; 279 		return;
 541  002f               L44:
 544  002f 85            	popw	x
 545  0030 81            	ret	
 546  0031               L37:
 547                     ; 283 		flag_IrDataIn = 1;
 549  0031 35010000      	mov	L34_flag_IrDataIn,#1
 550                     ; 284 		TIM2_SetCounter(0);
 552  0035 5f            	clrw	x
 553  0036 cd0000        	call	_TIM2_SetCounter
 555                     ; 290 	if ((cnt_ir_time >= 50)&&(cnt_ir_time < 55)) 
 557  0039 1e01          	ldw	x,(OFST-1,sp)
 558  003b a30032        	cpw	x,#50
 559  003e 2511          	jrult	L77
 561  0040 a30037        	cpw	x,#55
 562  0043 240c          	jruge	L77
 563                     ; 292 		ir_code.wData >>= 1;
 565  0045 3402          	srl	_ir_code
 566  0047 3603          	rrc	_ir_code+1
 567                     ; 293 		ir_code.bState++;
 569  0049 3c04          	inc	_ir_code+2
 570                     ; 294 		ir_code.wData |= 0x8000;
 572  004b 721e0002      	bset	_ir_code,#7
 573                     ; 295 		ir_code.boverflow = 0;
 575  004f 200f          	jra	L101
 576  0051               L77:
 577                     ; 298 	else if ((cnt_ir_time >=0)&&(cnt_ir_time < 50))
 579  0051 a30032        	cpw	x,#50
 580  0054 2408          	jruge	L301
 581                     ; 301 		ir_code.wData >>= 1;
 583  0056 3402          	srl	_ir_code
 584  0058 3603          	rrc	_ir_code+1
 585                     ; 302 		ir_code.bState++;
 587  005a 3c04          	inc	_ir_code+2
 588                     ; 303 		ir_code.boverflow = 0;
 590  005c 2002          	jra	L101
 591  005e               L301:
 592                     ; 313 		ir_code.bState = 0;
 594  005e 3f04          	clr	_ir_code+2
 595                     ; 314 		ir_code.boverflow = 0;
 597  0060               L101:
 600  0060 3f07          	clr	_ir_code+5
 601                     ; 317 	if (ir_code.bState == 16)
 603  0062 b604          	ld	a,_ir_code+2
 604  0064 a110          	cp	a,#16
 605  0066 260f          	jrne	L701
 606                     ; 319 		ir_code.wUserCode = ir_code.wData;
 608  0068 be02          	ldw	x,_ir_code
 609  006a bf05          	ldw	_ir_code+3,x
 610                     ; 320 		if(ir_code.wUserCode != 0x9d00)
 612  006c a39d00        	cpw	x,#40192
 613  006f 2704          	jreq	L111
 614                     ; 321 			ir_code.bState =0;
 616  0071 3f04          	clr	_ir_code+2
 618  0073 2002          	jra	L701
 619  0075               L111:
 620                     ; 323 			ir_code.wUserCode = ir_code.wData;
 622  0075 bf05          	ldw	_ir_code+3,x
 623  0077               L701:
 624                     ; 325 	if (ir_code.bState == 24)
 626  0077 b604          	ld	a,_ir_code+2
 627  0079 a118          	cp	a,#24
 628  007b 26b2          	jrne	L44
 629                     ; 327 		nop();
 632  007d 9d            	nop	
 634                     ; 328 		nop();
 638  007e 9d            	nop	
 641                     ; 331 } 
 643  007f 20ae          	jra	L44
 688                     ; 334 u8 Get_IrKey_Value(void)    //取IR键值
 688                     ; 335 {
 689                     .text:	section	.text,new
 690  0000               _Get_IrKey_Value:
 692  0000 5203          	subw	sp,#3
 693       00000003      OFST:	set	3
 696                     ; 336     u8 tkey = NO_KEY;
 698  0002 a6ff          	ld	a,#255
 699  0004 6b03          	ld	(OFST+0,sp),a
 700                     ; 337 		u16 tkey2 = NO_KEY;
 702                     ; 338     if (ir_code.bState != 24)
 704  0006 b604          	ld	a,_ir_code+2
 705  0008 a118          	cp	a,#24
 706  000a 2704          	jreq	L141
 707                     ; 340         return tkey;
 709  000c a6ff          	ld	a,#255
 711  000e 2018          	jra	L05
 712  0010               L141:
 713                     ; 345         if (ir_code.wUserCode == 0x9d00)//用户码为0X009d
 715  0010 be05          	ldw	x,_ir_code+3
 716  0012 a39d00        	cpw	x,#40192
 717  0015 260d          	jrne	L341
 718                     ; 347 			tkey2 = ir_code.wData;
 720  0017 be02          	ldw	x,_ir_code
 721                     ; 348 			tkey  = (u8)(tkey2 >>= 8);
 723  0019 4f            	clr	a
 724  001a 01            	rrwa	x,a
 725  001b 1f01          	ldw	(OFST-2,sp),x
 726  001d 7b02          	ld	a,(OFST-1,sp)
 727  001f 6b03          	ld	(OFST+0,sp),a
 728                     ; 350 			 nop();
 731  0021 9d            	nop	
 735  0022 2002          	jra	L541
 736  0024               L341:
 737                     ; 355         ir_code.bState = 0;
 739  0024 3f04          	clr	_ir_code+2
 740  0026               L541:
 741                     ; 357     return tkey;
 743  0026 7b03          	ld	a,(OFST+0,sp)
 745  0028               L05:
 747  0028 5b03          	addw	sp,#3
 748  002a 81            	ret	
 751                     	bsct
 752  0001               L741_last_key:
 753  0001 ff            	dc.b	255
 754  0002               L351_key_press_flag:
 755  0002 00            	dc.b	0
 756  0003               L551_nokey_press_counter:
 757  0003 0000          	dc.w	0
 758                     	switch	.ubsct
 759  0000               L151_key_press_counter:
 760  0000 0000          	ds.b	2
 864                     ; 360 void IrKey_Scan(void)    //IR按键识别
 864                     ; 361 {
 865                     .text:	section	.text,new
 866  0000               _IrKey_Scan:
 868       00000003      OFST:	set	3
 871                     ; 368     cur_key = NO_KEY;
 873                     ; 369 	IrKey_Value = NO_KEY;
 875  0000 35ff0000      	mov	_IrKey_Value,#255
 876  0004 5203          	subw	sp,#3
 877                     ; 370     back_last_key = last_key;
 879  0006 b601          	ld	a,L741_last_key
 880  0008 6b01          	ld	(OFST-2,sp),a
 881                     ; 372     cur_key = Get_IrKey_Value();
 883  000a cd0000        	call	_Get_IrKey_Value
 885  000d 6b03          	ld	(OFST+0,sp),a
 886                     ; 374 	if(cur_key == NO_KEY)
 888  000f a1ff          	cp	a,#255
 889  0011 2611          	jrne	L522
 890                     ; 376 		nokey_press_counter++;
 892  0013 be03          	ldw	x,L551_nokey_press_counter
 893  0015 5c            	incw	x
 894  0016 bf03          	ldw	L551_nokey_press_counter,x
 895                     ; 377 		if(nokey_press_counter == 1000)
 897  0018 a303e8        	cpw	x,#1000
 898  001b 2703cc00d6    	jrne	LC001
 899                     ; 379 			nop();
 902  0020 9d            	nop	
 904                     ; 380 			nokey_press_counter = 0;
 907  0021 5f            	clrw	x
 908  0022 bf03          	ldw	L551_nokey_press_counter,x
 910                     ; 384 			nop();
 914                     ; 385 			return;
 917  0024               L522:
 918                     ; 390     if (cur_key == last_key)                            //长时间按键
 920  0024 b101          	cp	a,L741_last_key
 921  0026 266f          	jrne	L332
 922                     ; 392         if ((cur_key == NO_KEY))
 924  0028 4c            	inc	a
 925  0029 2603          	jrne	L532
 926                     ; 394             return;
 927  002b               L601:
 930  002b 5b03          	addw	sp,#3
 931  002d 81            	ret	
 932  002e               L532:
 933                     ; 396 		nokey_press_counter = 0;
 935  002e 5f            	clrw	x
 936  002f bf03          	ldw	L551_nokey_press_counter,x
 937                     ; 398         key_press_counter++;
 939  0031 be00          	ldw	x,L151_key_press_counter
 940  0033 5c            	incw	x
 941  0034 bf00          	ldw	L151_key_press_counter,x
 942                     ; 400         if (key_press_counter == KEY_LONG_CNT)          //长按
 944  0036 a30078        	cpw	x,#120
 945  0039 262a          	jrne	L732
 946                     ; 402 			key_status = KEY_LONG;
 948                     ; 403             IrKey_Value = back_last_key;
 950  003b 7b01          	ld	a,(OFST-2,sp)
 951  003d b700          	ld	_IrKey_Value,a
 952                     ; 404 			if(IrKey_Value == KEY_IR_DOWM)
 954  003f a125          	cp	a,#37
 955  0041 2606          	jrne	L142
 956                     ; 406 				Display_Digital_Led(1);
 958  0043 ae0001        	ldw	x,#1
 960                     ; 407 				nop();
 966  0046 cc00d3        	jp	LC002
 967  0049               L142:
 968                     ; 409 			else if(IrKey_Value == KEY_IR_UP)
 970  0049 a185          	cp	a,#133
 971  004b 2606          	jrne	L542
 972                     ; 411 				Display_Digital_Led(2);
 974  004d ae0002        	ldw	x,#2
 976                     ; 412 				nop();
 982  0050 cc00d3        	jp	LC002
 983  0053               L542:
 984                     ; 414 			else if(IrKey_Value == KEY_IR_MODE)
 986  0053 a145          	cp	a,#69
 987  0055 2605          	jrne	L152
 988                     ; 416 				Display_Digital_Led(3);
 990  0057 ae0003        	ldw	x,#3
 992                     ; 417 				nop();
 998  005a 2077          	jp	LC002
 999  005c               L152:
1000                     ; 419 			else if(IrKey_Value == KEY_IR_POWER)
1002  005c a115          	cp	a,#21
1003  005e 26cb          	jrne	L601
1004                     ; 421 				Display_Digital_Led(4);
1006  0060 ae0004        	ldw	x,#4
1008                     ; 422 				nop();
1013  0063 206e          	jp	LC002
1014  0065               L732:
1015                     ; 425         else if (key_press_counter == (KEY_LONG_CNT + KEY_HOLD_CNT))        //连按
1017  0065 a3008c        	cpw	x,#140
1018  0068 26c1          	jrne	L601
1019                     ; 427             key_status = KEY_HOLD;
1021                     ; 428             IrKey_Value = back_last_key;
1023  006a 7b01          	ld	a,(OFST-2,sp)
1024  006c b700          	ld	_IrKey_Value,a
1025                     ; 429             key_press_counter = KEY_LONG_CNT;
1027  006e ae0078        	ldw	x,#120
1028  0071 bf00          	ldw	L151_key_press_counter,x
1029                     ; 430 			if(IrKey_Value == KEY_IR_DOWM)
1031  0073 a125          	cp	a,#37
1032  0075 2605          	jrne	L362
1033                     ; 432 				Display_Digital_Led(9);
1035  0077 ae0009        	ldw	x,#9
1037                     ; 433 				nop();
1043  007a 2057          	jp	LC002
1044  007c               L362:
1045                     ; 435 			else if(IrKey_Value == KEY_IR_UP)
1047  007c a185          	cp	a,#133
1048  007e 2605          	jrne	L762
1049                     ; 437 				Display_Digital_Led(9);
1051  0080 ae0009        	ldw	x,#9
1053                     ; 438 				nop();
1059  0083 204e          	jp	LC002
1060  0085               L762:
1061                     ; 440 			else if(IrKey_Value == KEY_IR_MODE)
1063  0085 a145          	cp	a,#69
1064  0087 2605          	jrne	L372
1065                     ; 442 				Display_Digital_Led(9);
1067  0089 ae0009        	ldw	x,#9
1069                     ; 443 				nop();
1075  008c 2045          	jp	LC002
1076  008e               L372:
1077                     ; 445 			else if(IrKey_Value == KEY_IR_POWER)
1079  008e a115          	cp	a,#21
1080  0090 2699          	jrne	L601
1081                     ; 447 				Display_Digital_Led(9);
1083  0092 ae0009        	ldw	x,#9
1085                     ; 448 				nop();
1090  0095 203c          	jp	LC002
1091                     ; 453             return;
1093  0097               L332:
1094                     ; 458 		last_key = cur_key;
1096  0097 b701          	ld	L741_last_key,a
1097                     ; 459 		nokey_press_counter = 0;
1099  0099 5f            	clrw	x
1100  009a bf03          	ldw	L551_nokey_press_counter,x
1101                     ; 461         if ((key_press_counter < KEY_LONG_CNT) && (cur_key != NO_KEY))
1103  009c be00          	ldw	x,L151_key_press_counter
1105                     ; 464         if ((key_press_counter < KEY_LONG_CNT) && (cur_key == NO_KEY))      //短按抬起
1107  009e a30078        	cpw	x,#120
1108  00a1 2440          	jruge	L703
1110  00a3 4c            	inc	a
1111  00a4 263d          	jrne	L703
1112                     ; 466             key_press_counter = 0;
1114  00a6 5f            	clrw	x
1115  00a7 bf00          	ldw	L151_key_press_counter,x
1116                     ; 468 			if((key_status == KEY_LONG)||(key_status == KEY_HOLD))
1118  00a9 7b02          	ld	a,(OFST-1,sp)
1119  00ab a101          	cp	a,#1
1120  00ad 2603cc002b    	jreq	L601
1122  00b2 a102          	cp	a,#2
1123                     ; 470 				key_status = KEY_SHORT_UP;
1125                     ; 471 				return;
1127  00b4 27f9          	jreq	L601
1128                     ; 474             IrKey_Value = back_last_key;
1130  00b6 7b01          	ld	a,(OFST-2,sp)
1131  00b8 b700          	ld	_IrKey_Value,a
1132                     ; 475 			if(IrKey_Value == KEY_IR_DOWM)
1134  00ba a125          	cp	a,#37
1135  00bc 2605          	jrne	L513
1136                     ; 477 				Display_Digital_Led(5);
1138  00be ae0005        	ldw	x,#5
1140                     ; 478 				nop();
1146  00c1 2010          	jp	LC002
1147  00c3               L513:
1148                     ; 480 			else if(IrKey_Value == KEY_IR_UP)
1150  00c3 a185          	cp	a,#133
1151  00c5 2605          	jrne	L123
1152                     ; 482 				Display_Digital_Led(6);
1154  00c7 ae0006        	ldw	x,#6
1156                     ; 483 				nop();
1162  00ca 2007          	jp	LC002
1163  00cc               L123:
1164                     ; 485 			else if(IrKey_Value == KEY_IR_MODE)
1166  00cc a145          	cp	a,#69
1167  00ce 260a          	jrne	L523
1168                     ; 487 				Display_Digital_Led(7);
1170  00d0 ae0007        	ldw	x,#7
1171  00d3               LC002:
1172  00d3 cd0000        	call	_Display_Digital_Led
1174                     ; 488 				nop();
1177  00d6               LC001:
1178  00d6 9d            	nop	
1182  00d7 cc002b        	jra	L601
1183  00da               L523:
1184                     ; 490 			else if(IrKey_Value == KEY_IR_POWER)
1186  00da a115          	cp	a,#21
1187  00dc 26f9          	jrne	L601
1188                     ; 492 				Display_Digital_Led(8);
1190  00de ae0008        	ldw	x,#8
1192                     ; 493 				nop();
1197  00e1 20f0          	jp	LC002
1198  00e3               L703:
1199                     ; 498             key_press_counter = 0;
1201  00e3 5f            	clrw	x
1202  00e4 bf00          	ldw	L151_key_press_counter,x
1203                     ; 499             return;
1205  00e6 cc002b        	jra	L601
1206                     ; 502 } 
1277                     	xdef	_IRTabFF00
1278                     	xref.b	_IrKey_Value
1279                     	switch	.ubsct
1280  0002               _ir_code:
1281  0002 000000000000  	ds.b	6
1282                     	xdef	_ir_code
1283                     	xref	_Display_Digital_Led
1284                     	xdef	_IrKey_Scan
1285                     	xdef	_Get_IrKey_Value
1286                     	xdef	_Ir_Receive
1287                     	xdef	_Ir_TimeOut
1288                     	xdef	_Init_TIM2
1289                     	xdef	_IrTask_Init
1290                     	xref	_TIM2_GetCounter
1291                     	xref	_TIM2_SetCounter
1292                     	xref	_TIM2_ITConfig
1293                     	xref	_TIM2_Cmd
1294                     	xref	_TIM2_TimeBaseInit
1295                     	xref	_TIM2_DeInit
1296                     	xref	_GPIO_Init
1297                     	xref	_EXTI_SetExtIntSensitivity
1298                     	xref	_EXTI_DeInit
1318                     	end
